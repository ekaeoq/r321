{"version":3,"names":["clipRules","evenodd","nonzero","propsAndStyles","props","style","Array","isArray","Object","assign","getMarker","marker","undefined","matched","match","idPattern","extractProps","ref","id","opacity","onLayout","clipPath","clipRule","display","mask","markerStart","markerMid","markerEnd","extracted","inherited","extractResponder","extractFill","extractStroke","length","propList","matrix","extractTransform","extractOpacity","name","String","console","warn","extract","instance","stringifyPropsForFabric","keys","forEach","k","withoutXY","x","y"],"sources":["extractProps.ts"],"sourcesContent":["import extractFill from './extractFill';\nimport extractStroke from './extractStroke';\nimport extractTransform from './extractTransform';\nimport extractResponder from './extractResponder';\nimport extractOpacity from './extractOpacity';\nimport { idPattern } from '../util';\nimport {\n  ClipProps,\n  extractedProps,\n  FillProps,\n  NumberProp,\n  ResponderProps,\n  StrokeProps,\n  TransformProps,\n} from './types';\n\nconst clipRules: { evenodd: number; nonzero: number } = {\n  evenodd: 0,\n  nonzero: 1,\n};\n\nexport function propsAndStyles(props: Object & { style?: [] | {} }) {\n  const { style } = props;\n  return !style\n    ? props\n    : {\n        ...(Array.isArray(style) ? Object.assign({}, ...style) : style),\n        ...props,\n      };\n}\n\nfunction getMarker(marker?: string) {\n  if (!marker) {\n    return undefined;\n  }\n  const matched = marker.match(idPattern);\n  return matched ? matched[1] : undefined;\n}\n\nexport default function extractProps(\n  props: {\n    id?: string;\n    mask?: string;\n    marker?: string;\n    markerStart?: string;\n    markerMid?: string;\n    markerEnd?: string;\n    clipPath?: string;\n    display?: string;\n    opacity?: NumberProp;\n    onLayout?: () => void;\n  } & TransformProps &\n    ResponderProps &\n    StrokeProps &\n    FillProps &\n    ClipProps,\n  ref: Object,\n) {\n  const {\n    id,\n    opacity,\n    onLayout,\n    clipPath,\n    clipRule,\n    display,\n    mask,\n    marker,\n    markerStart = marker,\n    markerMid = marker,\n    markerEnd = marker,\n  } = props;\n  const extracted: extractedProps = {};\n\n  const inherited: string[] = [];\n  extractResponder(extracted, props, ref);\n  extractFill(extracted, props, inherited);\n  extractStroke(extracted, props, inherited);\n\n  if (inherited.length) {\n    extracted.propList = inherited;\n  }\n\n  const matrix = extractTransform(props);\n  if (matrix !== null) {\n    extracted.matrix = matrix;\n  }\n\n  if (opacity != null) {\n    extracted.opacity = extractOpacity(opacity);\n  }\n\n  if (display != null) {\n    extracted.display = display === 'none' ? 'none' : undefined;\n  }\n\n  if (onLayout) {\n    extracted.onLayout = onLayout;\n  }\n\n  if (markerStart) {\n    extracted.markerStart = getMarker(markerStart);\n  }\n  if (markerMid) {\n    extracted.markerMid = getMarker(markerMid);\n  }\n  if (markerEnd) {\n    extracted.markerEnd = getMarker(markerEnd);\n  }\n\n  if (id) {\n    extracted.name = String(id);\n  }\n\n  if (clipRule) {\n    extracted.clipRule = clipRules[clipRule] === 0 ? 0 : 1;\n  }\n  if (clipPath) {\n    const matched = clipPath.match(idPattern);\n    if (matched) {\n      extracted.clipPath = matched[1];\n    } else {\n      console.warn(\n        'Invalid `clipPath` prop, expected a clipPath like \"#id\", but got: \"' +\n          clipPath +\n          '\"',\n      );\n    }\n  }\n\n  if (mask) {\n    const matched = mask.match(idPattern);\n\n    if (matched) {\n      extracted.mask = matched[1];\n    } else {\n      console.warn(\n        'Invalid `mask` prop, expected a mask like \"#id\", but got: \"' +\n          mask +\n          '\"',\n      );\n    }\n  }\n\n  return extracted;\n}\n\nexport function extract(instance: Object, props: Object & { style?: [] | {} }) {\n  return extractProps(propsAndStyles(props), instance);\n}\n\nexport function stringifyPropsForFabric(props: {\n  [key: string]: NumberProp | undefined | null;\n}): { [key: string]: string } {\n  const extracted: { [key: string]: string } = {};\n  Object.keys(props).forEach((k) => {\n    if (props[k] !== undefined && props[k] !== null) {\n      extracted[k] = String(props[k]);\n    }\n  });\n\n  return extracted;\n}\n\nexport function withoutXY(\n  instance: Object,\n  props: Object & { style?: [] | {} },\n) {\n  return extractProps({ ...propsAndStyles(props), x: null, y: null }, instance);\n}\n"],"mappings":"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"}