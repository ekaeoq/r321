{"version":3,"names":["getUriFromSource","source","resolvedAssetSource","Image","resolveAssetSource","uri","loadLocalRawResourceDefault","fetchText","isUriAnAndroidResourceIdentifier","indexOf","loadAndroidRawResource","RNSVGRenderableModule","require","default","getRawResource","e","console","error","loadLocalRawResourceAndroid","loadLocalRawResource","Platform","OS","LocalSvg","props","asset","rest","useState","xml","setXml","useEffect","then","WithLocalSvg","load","prevProps","setState","state","Component"],"sources":["LocalSvg.tsx"],"sourcesContent":["import React, { useState, useEffect, Component } from 'react';\nimport { Platform, Image, ImageSourcePropType } from 'react-native';\n\nimport { fetchText } from './xml';\nimport { SvgCss, SvgWithCss } from './css';\nimport { SvgProps } from './elements/Svg';\nimport type { Spec } from './fabric/NativeSvgRenderableModule';\n\nexport function getUriFromSource(source: ImageSourcePropType) {\n  const resolvedAssetSource = Image.resolveAssetSource(source);\n  return resolvedAssetSource.uri;\n}\n\nexport function loadLocalRawResourceDefault(source: ImageSourcePropType) {\n  const uri = getUriFromSource(source);\n  return fetchText(uri);\n}\n\nexport function isUriAnAndroidResourceIdentifier(uri?: string) {\n  return typeof uri === 'string' && uri.indexOf('/') <= -1;\n}\n\nexport async function loadAndroidRawResource(uri: string) {\n  try {\n    const RNSVGRenderableModule: Spec =\n      require('./fabric/NativeSvgRenderableModule').default;\n    return await RNSVGRenderableModule.getRawResource(uri);\n  } catch (e) {\n    console.error(\n      'Error in RawResourceUtils while trying to natively load an Android raw resource: ',\n      e,\n    );\n    return null;\n  }\n}\n\nexport function loadLocalRawResourceAndroid(source: ImageSourcePropType) {\n  const uri = getUriFromSource(source);\n  if (isUriAnAndroidResourceIdentifier(uri)) {\n    return loadAndroidRawResource(uri);\n  } else {\n    return fetchText(uri);\n  }\n}\n\nexport const loadLocalRawResource =\n  Platform.OS !== 'android'\n    ? loadLocalRawResourceDefault\n    : loadLocalRawResourceAndroid;\n\nexport type LocalProps = SvgProps & {\n  asset: ImageSourcePropType;\n  override?: Object;\n};\nexport type LocalState = { xml: string | null };\n\nexport function LocalSvg(props: LocalProps) {\n  const { asset, ...rest } = props;\n  const [xml, setXml] = useState<string | null>(null);\n  useEffect(() => {\n    loadLocalRawResource(asset).then(setXml);\n  }, [asset]);\n  return <SvgCss xml={xml} {...rest} />;\n}\n\nexport class WithLocalSvg extends Component<LocalProps, LocalState> {\n  state = { xml: null };\n  componentDidMount() {\n    this.load(this.props.asset);\n  }\n  componentDidUpdate(prevProps: { asset: ImageSourcePropType }) {\n    const { asset } = this.props;\n    if (asset !== prevProps.asset) {\n      this.load(asset);\n    }\n  }\n  async load(asset: ImageSourcePropType) {\n    try {\n      this.setState({ xml: asset ? await loadLocalRawResource(asset) : null });\n    } catch (e) {\n      console.error(e);\n    }\n  }\n  render() {\n    const {\n      props,\n      state: { xml },\n    } = this;\n    return <SvgWithCss xml={xml} override={props} />;\n  }\n}\n\nexport default LocalSvg;\n"],"mappings":"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"}